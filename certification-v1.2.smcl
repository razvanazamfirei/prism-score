{smcl}
{com}{sf}{ul off}{txt}{.-}
      name:  {res}certlog
       {txt}log:  {res}[REDACTED]/prism-score/certlog.smcl
  {txt}log type:  {res}smcl
 {txt}opened on:  {res}28 Feb 2023, 08:28:01
{txt}
{com}. 
. cscript prismscore adofile prismscore
{txt}{hline 63}BEGIN prismscore

-> which prismscore, usesysdir
[REDACTED]/Stata/ado/personal/prismscore.ado
{res}*! | Version: 1.2 | Last Updated: Feb 28, 2023
{txt}
{com}.     qui cd "./tests/data"
{txt}
{com}.     qui use "prism_3_dataset_5.dta"
{txt}
{com}.     datasignature confirm using "prism_3_dataset_5.dtasig", strict
{res}{txt}{p 2 3 2}
(data unchanged since 21nov2022 18:59{txt})
{p_end}

{com}.     
.     preserve
{txt}
{com}.     
.     * TEST REGULAR COMMAND
.     qui prismscore neuro_c nonneuro_c totalscore_c, ///
>         age(age) sbp(sbp) hr(hr) temp(temp_high) templow(temp_low) gcs(gcs) ///
>         pupils(pupils) ph(phlow) phhigh(phhigh) bicarb(bicarblow) ///
>         bicarbhigh(bicarbhigh) pco2(pco2) pao2(pao2) glucose(glucose) ///
>         potassium(potassium) creatinine(creatinine) bun(bun) wbc(wbc) ///
>         plt(plt) pt(pt) ptt(ptt)
{txt}
{com}. 
.         assert neuro_c == neuro 
{txt}
{com}.         assert nonneuro_c == nonneuro
{txt}
{com}.         assert totalscore_c == totalscore
{txt}
{com}.     
.     qui drop neuro_c nonneuro_c totalscore_c
{txt}
{com}.     
.     * TEST NAME COLLISION
.     rename temp_high temp
{res}{txt}
{com}.     rename temp_low templow
{res}{txt}
{com}.     rename phlow ph
{res}{txt}
{com}.     rename bicarblow bicarb
{res}{txt}
{com}.     
.     qui prismscore neuro_c nonneuro_c totalscore_c, ///
>         age(age) sbp(sbp) hr(hr) temp(temp) templow(templow) gcs(gcs) ///
>         pupils(pupils) ph(ph) phhigh(phhigh) bicarb(bicarb) ///
>         bicarbhigh(bicarbhigh) pco2(pco2) pao2(pao2) glucose(glucose) ///
>         potassium(potassium) creatinine(creatinine) bun(bun) wbc(wbc) ///
>         plt(plt) pt(pt) ptt(ptt)
{txt}
{com}.     
.         assert neuro_c == neuro
{txt}
{com}.         assert nonneuro_c == nonneuro
{txt}
{com}.         assert totalscore_c == totalscore
{txt}
{com}. 
.     qui drop neuro_c nonneuro_c totalscore_c
{txt}
{com}.     
.     restore
{txt}
{com}.     
.     * TEST UNIT OPTIONS AND AGE CALCULATIONS 
.     qui prismscore neuro_c nonneuro_c totalscore_c, ///
>         doa(doa) dob(dob) sbp(sbp) hr(hr) temp(temp_high) templow(temp_low) ///
>         gcs(gcs) pupils(pupils) ph(phlow) phhigh(phhigh) bicarb(bicarblow) ///
>         bicarbhigh(bicarbhigh) pco2(pco2) pao2(pao2) glucose(glucose_si) ///
>         potassium(potassium) creatinine(creatinine_si) bun(bun_si) ///
>         wbc(wbc_k) plt(plt_k) pt(pt) ptt(ptt) pltunit(1000) wbcunit(1000) si
{txt}
{com}. 
.         assert neuro_c == neuro
{txt}
{com}.         assert nonneuro_c == nonneuro
{txt}
{com}.         assert totalscore_c == totalscore
{txt}
{com}. 
.     qui drop neuro_c nonneuro_c totalscore_c
{txt}
{com}. 
.     clear
{txt}
{com}.     
.     * MOVE TO PRISM IV DATA
.     qui use "P4_Validated Data.dta"
{txt}
{com}.     datasignature confirm using "P4_Validated Data.dtasig", strict
{res}{txt}{p 2 3 2}
(data unchanged since 22nov2022 11:38{txt})
{p_end}

{com}. 
.     * TEST REGULAR COMMAND
.         qui prismscore neuro_c nonneuro_c totalscore_c score, ///
>         age(age) sbp(sbp) hr(hr) temp(temp_high) templow(temp_low) gcs(gcs) ///
>         pupils(pupils) ph(phlow) phhigh(phhigh) bicarb(bicarblow) ///
>         bicarbhigh(bicarbhigh) pco2(pco2) pao2(pao2) glucose(glucose) ///
>         potassium(potassium) creatinine(creatinine) bun(bun) wbc(wbc) ///
>         plt(plt) pt(pt) ptt(ptt) ///
>         prismiv source(source) risk(risk) cancer(cancer) cpr(cpr)
{txt}
{com}. 
.         assert abs(float(prism4) - float(score)) < 2 * 1E-2
{txt}
{com}.         assert neuro_c == neuro
{txt}
{com}.         assert nonneuro_c == nonneuro
{txt}
{com}.         assert totalscore_c == totalscore
{txt}
{com}. 
.         qui drop score neuro_c nonneuro_c totalscore_c
{txt}
{com}. 
.     * TEST UNIT OPTIONS AND AGE CALCULATIONS 
.         qui prismscore neuro_c nonneuro_c totalscore_c score, ///
>         dob(dob) doa(doa) sbp(sbp) hr(hr) temp(temp_high) templow(temp_low) ///
>         gcs(gcs) pupils(pupils) ph(phlow) phhigh(phhigh) bicarb(bicarblow) ///
>         bicarbhigh(bicarbhigh) pco2(pco2) pao2(pao2) glucose(glucose_si) ///
>         potassium(potassium) creatinine(creatinine_si) bun(bun_si) ///
>         wbc(wbc_k) plt(plt_k) pt(pt) ptt(ptt) pltunit(1000) wbcunit(1000) si ///
>         prismiv source(source) risk(risk) cancer(cancer) cpr(cpr)
{txt}
{com}. 
.         assert abs(float(prism4) - float(score)) < 2 * 1E-2
{txt}
{com}.         assert neuro_c == neuro
{txt}
{com}.         assert nonneuro_c == nonneuro
{txt}
{com}.         assert totalscore_c == totalscore
{txt}
{com}. 
.         qui drop score neuro_c nonneuro_c totalscore_c
{txt}
{com}.     
.         noi di as result "The following section will intentionally trigger errors and verify the appropriate error code. This test is passed succesfully if the last line displays: Certification completed succesfully."
{res}The following section will intentionally trigger errors and verify the appropriate error code. This test is passed succesfully if the last line displays: Certification completed succesfully.
{txt}
{com}. 
.         qui {c -(}
{err}You must specify either 1 or 4 newvariable names if you are trying to calculate the PRISM IV score. See help prismscore for more details.
You must specify either 1 or 4 newvariable names if you are trying to calculate the PRISM IV score. See help prismscore for more details.
You must specify 3 newvarvarnames for PRISM III score calculations. See help prismscore for more details.
You must specify 3 newvarvarnames for PRISM III score calculations. See help prismscore for more details.
You have specified too many newvarnamesor have forgotten to include prismiv
 not specified. See help prismscore for more details.
too few variables specified
 not specified. See help prismscore for more details.
too few variables specified
 not specified. See help prismscore for more details.
too few variables specified
 not specified. See help prismscore for more details.
too few variables specified
Platelet Unit incorrectly specified.
WBC Unit incorrectly specified.
Both age, DoB and DoA are specified.
Specify either age or DoB and DoA
too many variables specified
Neither age, DoB or DoA are specified.
Specify either age or DoB and DoA
too few variables specified
You must specify both DoB and DoA
too few variables specified
You must specify both DoB and DoA
too few variables specified
Age is not in the correct format. See help prismscore for more details.
You must specify either PT or PTT. See help prismscore for more details.
too few variables specified
Pupils are not in the correct format. See help prismscore for more details.
source is not in the correct format. See help prismscore for more details.
cpr is not binary. See help prismscore for more details.
0/1 variable required
cancer is not binary. See help prismscore for more details.
0/1 variable required
risk is not binary. See help prismscore for more details.
0/1 variable required
{txt}
{com}.         noi di as result "Certification completed succesfully. `c(current_date)' `c(current_time)'"
{res}Certification completed succesfully. 28 Feb 2023 08:28:14
{txt}
{com}. log close certlog
      {txt}name:  {res}certlog
       {txt}log:  {res}[REDACTED]/git/statistical-commands/stata-commands/prism-score/certlog.smcl
  {txt}log type:  {res}smcl
 {txt}closed on:  {res}28 Feb 2023, 08:28:14
{txt}{.-}
{smcl}
{txt}{sf}{ul off}
